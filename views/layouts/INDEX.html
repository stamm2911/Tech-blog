<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tech-blog</title>
    <link rel="stylesheet" href="../../public/css/jass.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6"
      crossorigin="anonymous"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Bungee+Shade&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css"
    />
    <link type="text/css" rel="stylesheet" href="../../public/css/styles.css" />
  </head>
  <body>
    <header>
      <h1>Tech Blog TEST!!!!!</h1>
      <div>
        <a href="/">Home</a>
      </div>
      <div>
        <a href="dashboard">Dashboard</a>
      </div>
      <div>
        <a href="login">Login</a>
      </div>
    </header>
    <main>
      <!-- --------------------------------------------------------------------- -->
      <article>
        <div class="post-title">
          <h2>Create a post</h2>
        </div>
        <form>
          <label>Title:</label>
          <br />
          <input
            id="new-post-title"
            class="comment-input"
            type="text"
            placeholder="Write a title..."
          />
          <br />
          <label>Content:</label>
          <br />
          <textarea
            id="new-post-content"
            class="comment-input"
            type="text"
          ></textarea>
          <!-- <hr
            style="height: 3px; border-width: 0; background-color: rgb(0, 0, 0)"
          /> -->
          <br />
        </form>
        <div id="new-post-container">  
          <button 
            id="new-post-form" 
            class="new-post-btn btn btn-danger btn-lg"> Submit
          </button>
          <button
            id="cl-new-post" class="new-post-btn btn btn-danger btn-lg"
          >
            Cancel
          </button>
        </div>
      </article>
      <!-- --------------------------------------------------------------------- -->
    </main>
  </body>
  <script>
    const clNewPost = document.getElementById('cl-new-post');
    const newPostForm = document.getElementById('new-post-form');
    const newPostContent = document.getElementById('new-post-content');
    const newPostTitle = document.getElementById('new-post-title');

    clNewPost.addEventListener('click',(e)=>{
      // document.location.replace('/dashboard')
      console.log('adios ')
    })

    newPostForm.addEventListener('click', async (e) => {
      // console.log(newPostTitle.value)
      // console.log(newPostContent.value)
      const newPostObj = {
        title: newPostTitle.value,
        content: newPostContent.value
      }
      console.log(JSON.stringify(newPostObj))
      const response = await fetch('/api/post',{
        method: 'POST',
        body: JSON.stringify(newPostObj),
        headers: {'Content-Type':'application/json'}
      })
      if(response.ok){
        document.location.replace('/dashboard');
      } else {
        alert('Failed to post!')
      }

    })
  </script>
</html>
